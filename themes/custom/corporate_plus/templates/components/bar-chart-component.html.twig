{#
/**
 * @file
 * Componente reutilizable para gráficos de barras.
 * 
 * @param chart_title - Título del gráfico (opcional)
 * @param y_labels - Array de etiquetas del eje Y
 * @param x_labels - Array de etiquetas del eje X
 * @param bar_data - Array de datos de las barras
 * @param chart_height - Altura del gráfico (por defecto: 400px)
 */
#}

<div class="chart-panel">
  {% if chart_title %}
    <h3 class="chart-title">{{ chart_title }}</h3>
  {% endif %}
  
  <div class="chart-container" style="height: {{ chart_height|default('400px') }};">
    {# Líneas de cuadrícula #}
    <div class="grid-lines">
      {% for i in 1..6 %}
        <div class="grid-line"></div>
      {% endfor %}
    </div>
    
    {# Eje Y #}
    <div class="y-axis">
      {% for label in y_labels %}
        <div class="y-label">{{ label }}</div>
      {% endfor %}
    </div>
    
    {# Gráfico de barras #}
    <div class="bar-chart">
      {% for year_data in bar_data %}
        <div class="bar-group">
          {% for bar in year_data.bars %}
            <div class="bar bar-{{ bar.color_index }}" style="height: {{ bar.height }}%;"></div>
          {% endfor %}
        </div>
      {% endfor %}
    </div>
    
    {# Eje X #}
    <div class="x-axis">
      {% for label in x_labels %}
        <div class="x-label">{{ label }}</div>
      {% endfor %}
    </div>
  </div>
</div>

<style>
/* Panel del gráfico */
.chart-panel {
  background: white !important;
  border-radius: 8px !important;
  padding: 2rem !important;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1) !important;
  margin-bottom: 2rem !important;
}

.chart-title {
  color: #1e3a8a !important;
  font-size: 1.5rem !important;
  font-weight: 600 !important;
  margin-bottom: 1.5rem !important;
  font-family: 'Cabin', sans-serif !important;
}

/* Contenedor del gráfico */
.chart-container {
  width: 100% !important;
  background: #f8f9fa !important;
  border-radius: 6px !important;
  border: 1px solid #e9ecef !important;
  position: relative !important;
  overflow: hidden !important;
}

/* Gráfico de barras */
.bar-chart {
  width: 100% !important;
  height: 100% !important;
  display: flex !important;
  align-items: flex-end !important;
  justify-content: space-between !important;
  padding: 2rem 1rem 3rem 4rem !important;
  position: relative !important;
}

/* Eje Y */
.y-axis {
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  bottom: 0 !important;
  width: 3rem !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: space-between !important;
  padding: 2rem 0.5rem 3rem 0.5rem !important;
  font-size: 0.8rem !important;
  color: #666 !important;
  font-family: 'Cabin', sans-serif !important;
}

.y-label {
  text-align: right !important;
  font-weight: 500 !important;
}

/* Eje X */
.x-axis {
  position: absolute !important;
  bottom: 0 !important;
  left: 4rem !important;
  right: 1rem !important;
  height: 2rem !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  font-size: 0.8rem !important;
  color: #666 !important;
  font-family: 'Cabin', sans-serif !important;
}

.x-label {
  text-align: center !important;
  font-weight: 500 !important;
}

/* Líneas de cuadrícula */
.grid-lines {
  position: absolute !important;
  top: 0 !important;
  left: 4rem !important;
  right: 1rem !important;
  bottom: 2rem !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: space-between !important;
}

.grid-line {
  height: 1px !important;
  background: #e9ecef !important;
  width: 100% !important;
}

/* Barras del gráfico */
.bar-group {
  display: flex !important;
  gap: 0.2rem !important;
  align-items: flex-end !important;
  height: 100% !important;
}

.bar {
  width: 20px !important;
  border-radius: 2px 2px 0 0 !important;
  position: relative !important;
  transition: all 0.3s ease !important;
}

.bar:hover {
  opacity: 0.8 !important;
  transform: scaleY(1.05) !important;
}

/* Colores de las barras */
.bar-1 { background: #1e3a8a !important; }
.bar-2 { background: #3b82f6 !important; }
.bar-3 { background: #0d9488 !important; }
.bar-4 { background: #dc2626 !important; }
.bar-5 { background: #8b5cf6 !important; }
.bar-6 { background: #f97316 !important; }
.bar-7 { background: #3b82f6 !important; }
.bar-8 { background: #eab308 !important; }
.bar-9 { background: #10b981 !important; }

/* Responsive */
@media (max-width: 768px) {
  .chart-container {
    height: 300px !important;
  }
  
  .bar {
    width: 15px !important;
  }
  
  .bar-chart {
    padding: 1.5rem 0.5rem 2.5rem 3rem !important;
  }
  
  .y-axis {
    width: 2.5rem !important;
    padding: 1.5rem 0.25rem 2.5rem 0.25rem !important;
  }
  
  .x-axis {
    left: 3rem !important;
    right: 0.5rem !important;
  }
  
  .grid-lines {
    left: 3rem !important;
    right: 0.5rem !important;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Funcionalidad para las barras del gráfico
  const bars = document.querySelectorAll('.bar');
  bars.forEach(bar => {
    bar.addEventListener('mouseenter', function() {
      this.style.transform = 'scaleY(1.1)';
    });
    
    bar.addEventListener('mouseleave', function() {
      this.style.transform = 'scaleY(1)';
    });
  });
});
</script> 